/*! For license information please see index.js.LICENSE.txt */
(()=>{var t={1488:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>h});var o=i(36758),s=i.n(o),n=i(40935),r=i.n(n)()(s());r.push([t.id,":host{font-family:var(--wh-font-family);box-sizing:border-box}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}:host{z-index:99999999 !important;visibility:visible !important}:host{line-height:14px}.highlighter-container{height:0;width:0}.highlighter-container .highlighter{z-index:9999 !important}.highlighter-container .highlighter{overflow:hidden;min-width:-moz-fit-content;min-width:fit-content;min-height:-moz-fit-content;min-height:fit-content;display:flex;justify-content:center;opacity:0;animation:slideOut 300ms forwards;visibility:hidden;transition:opacity 300ms,visibility 300ms}.highlighter-container .highlighter.slideIn{visibility:visible !important;opacity:1 !important;animation:slideIn 300ms forwards !important}.highlighter-container .highlighter.slideIn{overflow:visible}.highlighter-container .highlighter.slideOut{visibility:hidden !important;opacity:0 !important;animation:slideOut 300ms forwards !important}@keyframes slideIn{100%{-webkit-transform:translate(0%, -100%)}0%{-webkit-transform:translate(0%, -300%)}}@keyframes slideOut{100%{-webkit-transform:translate(0%, -300%)}0%{-webkit-transform:translate(0%, -100%)}}",""]);const h=r},30827:(t,e,i)=>{"use strict";i.d(e,{y:()=>n});var o=i(38085),s=i(93811);class n extends s.LitElement{constructor(){super(...arguments),this.components=[],this.subscriptions=[]}connectedCallback(){super.connectedCallback(),(0,o.lazyDefine)(this.components)}disconnectedCallback(){super.disconnectedCallback(),this.unsubscribe()}unsubscribe(){this.subscriptions.forEach(t=>{t.unsubscribe()})}static define(t,e,i){(0,o.defineWebHighlightsElement)(t,e,i)}}},33691:(t,e,i)=>{var o=i(1488);o&&o.__esModule&&(o=o.default),t.exports="string"==typeof o?o:o.toString()},36758:t=>{"use strict";t.exports=function(t){return t[1]}},36774:(t,e,i)=>{"use strict";i.d(e,{YZ:()=>o.YZ});var o=i(57929)},38085:t=>{"use strict";t.exports=WebHighlightsSharedLibExternal},40935:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i="",o=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),o&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),o&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i}).join("")},e.i=function(t,i,o,s,n){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(o)for(var h=0;h<this.length;h++){var a=this[h][0];null!=a&&(r[a]=!0)}for(var l=0;l<t.length;l++){var d=[].concat(t[l]);o&&r[d[0]]||(void 0!==n&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=n),i&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=i):d[2]=i),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),e.push(d))}},e}},50576:(t,e,i)=>{"use strict";var o=i(93811),s=i(95665),n=i(36774),r=i(38085),h=i(30827),a=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t,e,i,o){return new(i||(i=Promise))(function(s,n){function r(t){try{a(o.next(t))}catch(t){n(t)}}function h(t){try{a(o.throw(t))}catch(t){n(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,h)}a((o=o.apply(t,e||[])).next())})};const d=i(54103),c=r.SHARED_COMPONENTS_INTERNAL.Highlighter,p=t=>"highlight-text"===t.name;class u extends h.y{constructor(){super(),this.components=[r.SHARED_COMPONENTS.RecentColors.TAG,r.SHARED_COMPONENTS.Icon.TAG,r.SHARED_COMPONENTS.Tooltip.TAG,r.SHARED_COMPONENTS.MediaTypeMenu.TAG,r.SHARED_COMPONENTS.Dropdown.TAG],this.show=!1,this.showHidePopupMenu=!1,this.keepRecentColorsOpen=!1,this._highlightTextCommand=new n.YZ(this,{task:()=>l(this,void 0,void 0,function*(){return this.readHighlightTextCommand()}),args:()=>[]}),this.onDefaultColorUpdate=t=>l(this,void 0,void 0,function*(){const e=t.detail;yield(0,r.updateChromeSettings)({defaultHighlightColor:e})}),this.onRecentColorSelect=t=>l(this,void 0,void 0,function*(){const e=t.detail;yield this.saveMark({color:e});const{recentColors:i}=yield(0,r.useContext)().db.getChromeSettings(),o=[e,...i].slice(0,10);yield(0,r.updateChromeSettings)({recentColors:o})}),this._shouldShowMediaTypeMenu=new n.YZ(this,{task:t=>l(this,[t],void 0,function*([t]){var e;return t===r.HighlighterMode.EXPERT||void 0===(null===(e=this.chromeSettings)||void 0===e?void 0:e.highlighterMode)&&(yield(0,r.useContext)().db.getAllCount(r.ObjectStoreNameSyncable.marks))>=2}),args:()=>{var t;return[null===(t=this.chromeSettings)||void 0===t?void 0:t.highlighterMode]}})}readHighlightTextCommand(){return l(this,void 0,void 0,function*(){if(!(0,r.shouldShowShortcuts)(location.href))return null;const t=yield r.chromeMessageService.readCommands();return null==t?void 0:t.find(p)})}get highlightColor(){var t,e;return null!==(e=null===(t=this.chromeSettings)||void 0===t?void 0:t.defaultHighlightColor)&&void 0!==e?e:r.fallbackChromeSettings.defaultHighlightColor}onAddMarkClick(t){return l(this,void 0,void 0,function*(){return t.preventDefault(),this.saveMark()})}saveMark(t){return l(this,void 0,void 0,function*(){this.show=!1;const e=(0,r.generateNewMark)((null==t?void 0:t.color)||this.highlightColor,{mediaType:null==t?void 0:t.mediaType});if(e)return(0,r.createMark)(e)})}onMarkCreatedFromMediaTypeItem(t){return l(this,void 0,void 0,function*(){return this.saveMark({mediaType:t.detail.type})})}onGoToShortcuts(t){(0,r.stopPropagation)(t),(0,r.goToShortcutSettings)()}onHidePopupClick(t){t.preventDefault(),(0,r.stopPropagation)(t),this.showHidePopupMenu=!this.showHidePopupMenu}onAddNewColorClick(t){this.keepRecentColorsOpen=!0}onHidePopupUntilNextVisit(){return l(this,void 0,void 0,function*(){(0,r.hidePopupUntilNextVisit)(),this.remove()})}onHidePopupAlways(){return l(this,void 0,void 0,function*(){yield(0,r.updateChromeSettings)({showMarkerPopup:!1});const t="background: none; border: none; color: var(--wh-primary-500); text-decoration: underline; display: inline-block; padding: 0; cursor: pointer;";(0,r.showToast)({content:o.html`Popup disabled. Reactivate it in
        <button @click=${r.openSettingsDialog} style="${t}">
          settings
        </button>
        or highlight by right-clicking or using
        <button @click=${r.goToShortcutSettings} style="${t}">
          shortcuts</button
        >.`,uniqueId:"hide-popup-always-info",variant:"neutral",duration:1e4}),this.remove()})}onDisableOnCurrentWebsite(){return l(this,void 0,void 0,function*(){return(0,r.addCurrentUrlToBlacklist)()})}render(){var t,e,i,s;return o.html`
      <div
        class="highlighter-container"
        tabindex="0"
        data-testid=${r.SHARED_COMPONENTS_INTERNAL.PopupToolboxMenu.TEST_IDS.MENU_CONTAINER}
      >
        <style>
          .markIcon,
          .colorIcon {
            transition: 0.2s fill ease-in-out;
            fill: white !important;
          }
          .markIcon:hover,
          .btn:hover .markIcon {
            fill: ${this.highlightColor} !important;
          }
          .btn.active .tagIcon {
            color: ${this.highlightColor} !important;
          }
        </style>
        <!-- Add / remove mark -->
        <div
          id="add-mark-container"
          aria-label="Highlight text"
          tabindex="1"
          class="btn"
        >
          ${this.highlightColor?o.html`
                <webhighlights-recent-colors
                  .recentColors="${null!==(e=null===(t=this.chromeSettings)||void 0===t?void 0:t.recentColors)&&void 0!==e?e:[]}"
                  .highlightColor="${this.highlightColor}"
                  class="${this.keepRecentColorsOpen?"keep-open":""}"
                  popupPosition="right"
                  .defaultHighlightColor=${null!==(s=null===(i=this.chromeSettings)||void 0===i?void 0:i.defaultHighlightColor)&&void 0!==s?s:r.fallbackChromeSettings.defaultHighlightColor}
                  @addNewColorClick=${this.onAddNewColorClick}
                  @selectColor=${this.onRecentColorSelect}
                  @updateDefaultColor=${this.onDefaultColorUpdate}
                ></webhighlights-recent-colors>
              `:""}
          ${this._highlightTextCommand.render({pending:()=>o.html``,complete:t=>t?o.html`<div class="tooltip-wrapper create-highlight">
                    <webhighlights-tooltip position="left">
                      ${t.description} (<a
                        class="shortcut-link"
                        href=${r.EXTENSION_SHORTCUT_URL}
                        @click=${this.onGoToShortcuts}
                        >${t.shortcut}</a
                      >)</webhighlights-tooltip
                    >
                  </div>`:o.html``})}
          <button
            id="add-mark-btn"
            @click=${this.onAddMarkClick}
            title="Highlight text"
            aria-label="Highlight text"
            data-testid=${c.TEST_IDS.HIGHLIGHT_BTN}
            tabindex="1"
            class="btn"
          >
            <svg
              class="icon markIcon"
              data-testid=${c.TEST_IDS.HIGHLIGHT_ICON}
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 544 512"
            >
              <path
                d="M0 479.98L99.92 512l35.45-35.45-67.04-67.04L0 479.98zm124.61-240.01a36.592 36.592 0 0 0-10.79 38.1l13.05 42.83-50.93 50.94 96.23 96.23 50.86-50.86 42.74 13.08c13.73 4.2 28.65-.01 38.15-10.78l35.55-41.64-173.34-173.34-41.52 35.44zm403.31-160.7l-63.2-63.2c-20.49-20.49-53.38-21.52-75.12-2.35L190.55 183.68l169.77 169.78L530.27 154.4c19.18-21.74 18.15-54.63-2.35-75.13z"
              />
            </svg>
          </button>
          ${this._shouldShowMediaTypeMenu.render({pending:()=>o.html``,complete:t=>t?o.html`
                    <webhighlights-media-type-menu
                      class="media-type-container"
                      .chromeSettings=${this.chromeSettings}
                      @itemSelected=${this.onMarkCreatedFromMediaTypeItem}
                    ></webhighlights-media-type-menu>
                  `:o.html``})}
        </div>
      </div>

      <div class="hide-popup-container">
        <webhighlights-dropdown position="left">
          <button
            slot="trigger"
            aria-label="Hide popup"
            class="hide-popup-btn"
            data-testid=${c.TEST_IDS.HIDE_POPUP_BTN}
          >
            <webhighlights-icon
              icon="${r.ICON_NAMES["delete-x"]}"
              size="8"
              strokeWidth="2"
            ></webhighlights-icon>
          </button>
          <div slot="content" class="hide-popup-dropdown-content">
            <button
              class="hide-popup-dropdown-item"
              data-testid=${c.TEST_IDS.HIDE_POPUP_UNTIL_NEXT_VISIT}
              @click=${this.onHidePopupUntilNextVisit}
            >
              <webhighlights-icon
                slot="prefix"
                icon=${r.ICON_NAMES.pause}
                .size=${16}
                strokeWidth="1.5"
              ></webhighlights-icon>
              Hide until next visit
            </button>
            <button
              class="hide-popup-dropdown-item"
              data-testid=${c.TEST_IDS.HIDE_POPUP_ON_CURRENT_WEBSITE}
              @click=${this.onDisableOnCurrentWebsite}
            >
              <webhighlights-icon
                slot="prefix"
                icon=${r.ICON_NAMES.power}
                .size=${16}
                strokeWidth="1.5"
              ></webhighlights-icon>
              Disable on this website
            </button>
            <button
              class="hide-popup-dropdown-item"
              data-testid=${c.TEST_IDS.HIDE_POPUP_ALWAYS}
              @click=${this.onHidePopupAlways}
            >
              <webhighlights-icon
                slot="prefix"
                icon=${r.ICON_NAMES["eye-off"]}
                .size=${16}
                strokeWidth="1.5"
              ></webhighlights-icon>
              Always hide popup
            </button>
          </div>
        </webhighlights-dropdown>
      </div>
    `}}u.styles=o.css`
    ${(0,o.unsafeCSS)(d)}
  `,a([(0,s.property)()],u.prototype,"show",void 0),a([(0,s.property)()],u.prototype,"showHidePopupMenu",void 0),a([(0,s.property)()],u.prototype,"chromeSettings",void 0),a([(0,s.state)()],u.prototype,"keepRecentColorsOpen",void 0),h.y.define(c.TAG,u)},54103:(t,e,i)=>{var o=i(88608);o&&o.__esModule&&(o=o.default),t.exports="string"==typeof o?o:o.toString()},57929:(t,e,i)=>{"use strict";i.d(e,{YZ:()=>n});var o=i(58207);const s=Symbol();class n{get taskComplete(){return this.t||(1===this.i?this.t=new Promise((t,e)=>{this.o=t,this.h=e}):3===this.i?this.t=Promise.reject(this.l):this.t=Promise.resolve(this.u)),this.t}constructor(t,e,i){this.p=0,this.i=0,(this._=t).addController(this);const o="object"==typeof e?e:{task:e,args:i};this.v=o.task,this.j=o.args,this.m=o.argsEqual??r,this.k=o.onComplete,this.A=o.onError,this.autoRun=o.autoRun??!0,"initialValue"in o&&(this.u=o.initialValue,this.i=2,this.O=this.T?.())}hostUpdate(){!0===this.autoRun&&this.S()}hostUpdated(){"afterUpdate"===this.autoRun&&this.S()}T(){if(void 0===this.j)return;const t=this.j();if(!Array.isArray(t))throw Error("The args function must return an array");return t}async S(){const t=this.T(),e=this.O;this.O=t,t===e||void 0===t||void 0!==e&&this.m(e,t)||await this.run(t)}async run(t){let e,i;t??=this.T(),this.O=t,1===this.i?this.q?.abort():(this.t=void 0,this.o=void 0,this.h=void 0),this.i=1,"afterUpdate"===this.autoRun?queueMicrotask(()=>this._.requestUpdate()):this._.requestUpdate();const o=++this.p;this.q=new AbortController;let n=!1;try{e=await this.v(t,{signal:this.q.signal})}catch(t){n=!0,i=t}if(this.p===o){if(e===s)this.i=0;else{if(!1===n){try{this.k?.(e)}catch{}this.i=2,this.o?.(e)}else{try{this.A?.(i)}catch{}this.i=3,this.h?.(i)}this.u=e,this.l=i}this._.requestUpdate()}}abort(t){1===this.i&&this.q?.abort(t)}get value(){return this.u}get error(){return this.l}get status(){return this.i}render(t){switch(this.i){case 0:return t.initial?.();case 1:return t.pending?.();case 2:return t.complete?.(this.value);case 3:return t.error?.(this.error);default:throw Error("Unexpected status: "+this.i)}}}const r=(t,e)=>t===e||t.length===e.length&&t.every((t,i)=>!(0,o.Ec)(t,e[i]))},58207:(t,e,i)=>{"use strict";i.d(e,{Ec:()=>m});var o=i(86663);const{is:s,defineProperty:n,getOwnPropertyDescriptor:r,getOwnPropertyNames:h,getOwnPropertySymbols:a,getPrototypeOf:l}=Object,d=globalThis,c=d.trustedTypes,p=c?c.emptyScript:"",u=d.reactiveElementPolyfillSupport,g=(t,e)=>t,f={toAttribute(t,e){switch(e){case Boolean:t=t?p:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},m=(t,e)=>!s(t,e),v={attribute:!0,type:String,converter:f,reflect:!1,useDefault:!1,hasChanged:m};Symbol.metadata??=Symbol("metadata"),d.litPropertyMetadata??=new WeakMap;class b extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=v){if(e.state&&(e.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((e=Object.create(e)).wrapped=!0),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),o=this.getPropertyDescriptor(t,i,e);void 0!==o&&n(this.prototype,t,o)}}static getPropertyDescriptor(t,e,i){const{get:o,set:s}=r(this.prototype,t)??{get(){return this[e]},set(t){this[e]=t}};return{get:o,set(e){const n=o?.call(this);s?.call(this,e),this.requestUpdate(t,n,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??v}static _$Ei(){if(this.hasOwnProperty(g("elementProperties")))return;const t=l(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(g("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(g("properties"))){const t=this.properties,e=[...h(t),...a(t)];for(const i of e)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const e=litPropertyMetadata.get(t);if(void 0!==e)for(const[t,i]of e)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,e]of this.elementProperties){const i=this._$Eu(t,e);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift((0,o.sk)(t))}else void 0!==t&&e.push((0,o.sk)(t));return e}static _$Eu(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return(0,o.Rf)(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$ET(t,e){const i=this.constructor.elementProperties.get(t),o=this.constructor._$Eu(t,i);if(void 0!==o&&!0===i.reflect){const s=(void 0!==i.converter?.toAttribute?i.converter:f).toAttribute(e,i.type);this._$Em=t,null==s?this.removeAttribute(o):this.setAttribute(o,s),this._$Em=null}}_$AK(t,e){const i=this.constructor,o=i._$Eh.get(t);if(void 0!==o&&this._$Em!==o){const t=i.getPropertyOptions(o),s="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:f;this._$Em=o;const n=s.fromAttribute(e,t.type);this[o]=n??this._$Ej?.get(o)??n,this._$Em=null}}requestUpdate(t,e,i){if(void 0!==t){const o=this.constructor,s=this[t];if(i??=o.getPropertyOptions(t),!((i.hasChanged??m)(s,e)||i.useDefault&&i.reflect&&s===this._$Ej?.get(t)&&!this.hasAttribute(o._$Eu(t,i))))return;this.C(t,e,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,e,{useDefault:i,reflect:o,wrapped:s},n){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,n??e??this[t]),!0!==s||void 0!==n)||(this._$AL.has(t)||(this.hasUpdated||i||(e=void 0),this._$AL.set(t,e)),!0===o&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,e]of this._$Ep)this[t]=e;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[e,i]of t){const{wrapped:t}=i,o=this[e];!0!==t||this._$AL.has(e)||void 0===o||this.C(e,void 0,i,o)}}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach(t=>t.hostUpdate?.()),this.update(e)):this._$EM()}catch(e){throw t=!1,this._$EM(),e}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(t=>this._$ET(t,this[t])),this._$EM()}updated(t){}firstUpdated(t){}}b.elementStyles=[],b.shadowRootOptions={mode:"open"},b[g("elementProperties")]=new Map,b[g("finalized")]=new Map,u?.({ReactiveElement:b}),(d.reactiveElementVersions??=[]).push("2.1.1")},86663:(t,e,i)=>{"use strict";i.d(e,{Rf:()=>a,sk:()=>l});const o=globalThis,s=o.ShadowRoot&&(void 0===o.ShadyCSS||o.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,n=Symbol(),r=new WeakMap;class h{constructor(t,e,i){if(this._$cssResult$=!0,i!==n)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(s&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=r.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&r.set(e,t))}return t}toString(){return this.cssText}}const a=(t,e)=>{if(s)t.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const i of e){const e=document.createElement("style"),s=o.litNonce;void 0!==s&&e.setAttribute("nonce",s),e.textContent=i.cssText,t.appendChild(e)}},l=s?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return(t=>new h("string"==typeof t?t:t+"",void 0,n))(e)})(t):t},88608:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>h});var o=i(36758),s=i.n(o),n=i(40935),r=i.n(n)()(s());r.push([t.id,':host{font-family:var(--wh-font-family);box-sizing:border-box}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.wh-loading-skeleton{color:rgba(0,0,0,0);opacity:.8;animation:1.25s linear 0s infinite normal none running loadingBlinking;background:var(--wh-skeleton-bg);border-radius:4px;position:relative;overflow:hidden}.wh-loading-skeleton::after{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, var(--wh-skeleton-bg-hover), transparent);animation:skeleton-shimmer 2s infinite}@keyframes loadingBlinking{0%{background:var(--wh-skeleton-bg)}70%{background:var(--wh-skeleton-bg-hover)}100%{background:var(--wh-skeleton-bg-strong)}}@keyframes skeleton-shimmer{0%{left:-100%}100%{left:100%}}:host{z-index:9999 !important}:host{color:#fff;height:18px;margin:-10px auto 0px auto;margin-bottom:100px}.highlighter-container{z-index:9999 !important}.highlighter-container{color:var(--wh-gray-200);display:flex;display:flex;justify-content:space-between;align-items:center}.highlighter-container.extended{gap:12px;padding:0px 8px}.highlighter-container webhighlights-recent-colors:not(.keep-open){display:none}.highlighter-container:hover webhighlights-recent-colors{display:block}.icon{fill:var(--wh-text);color:var(--wh-text);width:18px;height:18px;margin:auto}.icon:hover{fill:#fff;color:#fff}.icon.trash{fill:none}.markIcon{width:18px !important;height:18px !important}.btn.user{border-left:1px solid rgba(187,187,187,.459)}.btn{display:flex;align-items:center}.btn:hover .colorIcon{fill:var(--wh-primary-color)}.icon.user-icon:hover{color:var(--wh-primary-color)}.btn{z-index:9999;padding:0;border:none;background:none;cursor:pointer}button:focus{outline:0}webhighlights-color-picker{--color-picker-size: 20px}#add-mark-container{display:flex;align-items:center;justify-content:center;border-radius:5px;background-color:var(--wh-secondary-600);box-shadow:var(--wh-shadow)}#add-mark-container .tooltip-wrapper{visibility:hidden;font-size:10px;transition:all .35s;transition-delay:.2;opacity:0;width:0;height:0}#add-mark-container:hover .tooltip-wrapper{visibility:visible;opacity:1;line-height:12px;background:var(--wh-bg-front)}#add-mark-container .shortcut-link{color:inherit}#add-mark-container webhighlights-tooltip{--background-color: var(--wh-secondary-600)}#add-mark-container .tooltip-wrapper.delete-highlight webhighlights-tooltip{transform:translateY(-8px)}#add-mark-container .tooltip-wrapper.create-highlight webhighlights-tooltip{transform:translate(-6px, -6px)}#add-mark-btn{padding:2.5px 7px;transition:.2s all ease-in-out;border-radius:5px}webhighlights-media-type-dropdown-item::part(blocktype-dropdown-item-btn){padding:2px 8px}.highlighter-container .media-type-container{transition:all .4s ease-in-out;width:0}.highlighter-container:hover .media-type-container{width:186px}.header-toolbar{--wh-toolbar-icon-size: 18px}.hide-popup-container{position:absolute;left:-12px;top:-12px;z-index:40;padding:0;z-index:9999}.hide-popup-btn{cursor:pointer;color:var(--wh-gray-600);background:#fff;border:none;border-radius:50%;padding:1px;transition:.1s ease-in-out;box-shadow:var(--wh-shadow)}.hide-popup-btn:hover,.hide-popup-btn:focus{background:var(--wh-gray-100)}.hide-popup-dropdown{padding:8px;color:var(--wh-gray-900);font-family:var(--wh-font-family)}.hide-popup-dropdown-content{display:flex;flex-direction:column;min-width:190px;padding:4px}.hide-popup-dropdown-item{display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px;background-color:#fff;color:var(--wh-gray-700);font-size:14px;border:none;border-radius:4px}.hide-popup-dropdown-item:hover{background-color:var(--wh-gray-100)}',""]);const h=r},93811:t=>{"use strict";t.exports=LitExternal},95665:t=>{"use strict";t.exports=LitDecoratorsExternal}},e={};function i(o){var s=e[o];if(void 0!==s)return s.exports;var n=e[o]={id:o,exports:{}};return t[o](n,n.exports,i),n.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=i(38085),e=i(93811),o=i(95665),s=i(30827),n=(i(50576),function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r}),r=function(t,e,i,o){return new(i||(i=Promise))(function(s,n){function r(t){try{a(o.next(t))}catch(t){n(t)}}function h(t){try{a(o.throw(t))}catch(t){n(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,h)}a((o=o.apply(t,e||[])).next())})};const h=i(33691),a=t.SHARED_COMPONENTS.Marker;class l extends s.y{constructor(){super(...arguments),this.show=!1,this.menuWidth=80,this.firstInitWasCalled=!1,this.mouseUpHandler=e=>{if(e instanceof MouseEvent){const t="number"==typeof e.button?e.button:0;if(2===t||1===t)return}(0,t.shouldShowMarker)()&&this.chromeSettings.showMarkerPopup&&!(0,t.isPopupHiddenUntilNextVisit)()?(this.setPositionOfMarkerForClick(e),this.show=!0,(0,t.handleSpecialCasesWhenShowingMarker)()):this.closeMarker()},this.selectionChangeHandler=()=>{!this.show||(0,t.shouldShowMarker)()?(0,t.isMobileTouchDevice)()&&(this.lastSelectionTime=Date.now(),setTimeout(()=>{const e=window.getSelection();if(Date.now()-this.lastSelectionTime>=250&&(0,t.shouldShowMarker)()&&e){const i=e.getRangeAt(0).getBoundingClientRect();this.setPositionOfMarkerForSelection(i),this.show=!0,(0,t.handleSpecialCasesWhenShowingMarker)()}},250)):this.closeMarker()},this.scrollHandler=()=>{this.closeMarker()},this.closeMarker=()=>{this.show=!1},this.lastSelectionTime=0}get db(){return(0,t.useContext)().db}init(){return r(this,void 0,void 0,function*(){this.initListeners();const[e]=yield Promise.all([this.db.getChromeSettings(),(0,t.highlightMarks)()]);this.chromeSettings=e,this.firstInitWasCalled||(this.createPdfHint(),(0,t.handleKindleLogic)(),this.createLearningReminderTeaser(e)),this.firstInitWasCalled=!0})}disconnectedCallback(){this.removeListenToShowMarkerListener(),super.disconnectedCallback()}initListeners(){this.unsubscribe(),this.listenToShowMarker(),this.subscriptions=[t.notifications.subscribe("updatedChromeSettings",this.onChromeSettingsChanged.bind(this)),t.notifications.subscribe("locationHrefChanged",this.onLocationHrefChanged.bind(this)),t.notifications.subscribe("serverUpdateDone",this.onServerUpdateDone.bind(this)),t.notifications.subscribe("selectedTag",this.onSelectedTag.bind(this)),t.notifications.subscribe("selectedDomain",this.onSelectedDomain.bind(this))]}onSelectedTag(e){t.notifications.dispatch("closePopover",{detail:null}),(0,t.closeDialog)(),(0,t.sidebarIsOpen)()||t.notifications.dispatch("toggleSidebar",{detail:null}),(0,t.navigateToTab)(t.EXTENSION_TAB_VIEW.TAGS_VIEW,{activeTag:e.detail.tag})}onSelectedDomain(e){t.notifications.dispatch("closePopover",{detail:null}),(0,t.closeDialog)(),(0,t.navigateToTab)(t.EXTENSION_TAB_VIEW.DOMAINS_VIEW,{activeDomain:e.detail.domain})}onLocationHrefChanged(t){this.init().then().catch()}onChromeSettingsChanged(t){this.chromeSettings=Object.assign(Object.assign({},this.chromeSettings),t.detail)}onServerUpdateDone(t){t.detail.chromesettings[0]&&(this.chromeSettings=t.detail.chromesettings[0])}createLearningReminderTeaser(e){return r(this,void 0,void 0,function*(){if(!(null==e?void 0:e.showLearningTeaser))return!1;const i=yield this.db.getLearningStatus();(0,t.shouldShowLearningTeaser)(i,e)&&(0,t.showLearningReminder)(()=>{},{position:{right:10,top:10},hideBackdrop:!0})})}createPdfHint(){const e=location.href,i=!!document.getElementById(t.PDF_HINT_ID);if(!i&&(0,t.isPdfPage)(e)&&!(0,t.isExtensionPdfPage)(e)&&!i){const e=document.createElement(t.SHARED_COMPONENTS.PdfHint.TAG);document.body.appendChild(e)}}listenToShowMarker(){document.addEventListener("selectionchange",this.selectionChangeHandler),document.addEventListener("mouseup",this.mouseUpHandler),document.addEventListener("scroll",this.scrollHandler)}removeListenToShowMarkerListener(){document.removeEventListener("selectionchange",this.selectionChangeHandler),document.removeEventListener("mouseup",this.mouseUpHandler),document.removeEventListener("scroll",this.scrollHandler)}setPositionOfMarkerForClick(e){var i,o,s;if((0,t.isSpecificCustomElementTarget)(e.target,t.SHARED_COMPONENTS.PopupToolbox.TAG)||(0,t.isSpecificCustomElementTarget)(e.target,t.SHARED_COMPONENTS.Marker.TAG))return;const n=null===(i=window.getSelection())||void 0===i?void 0:i.toString();this.style.position="fixed";const r=null===(o=(0,t.resolveRangeFromSelection)(window.getSelection()))||void 0===o?void 0:o.getBoundingClientRect(),h=e.isTrusted;(null===(s=null==n?void 0:n.trim())||void 0===s?void 0:s.length)&&(h?(this.style.left=e.clientX-10+"px",this.style.top=e.clientY-8+"px"):r&&(this.style.left=r.left+r.width/2-this.menuWidth/2-35+"px",this.style.top=r.top+"px"))}setPositionOfMarkerForSelection(t){this.style.position="fixed",this.style.left=t.left+t.width/2-this.menuWidth/2+"px",this.style.top=`${t.bottom+8}px`}render(){return e.html`
      ${this.show?e.html`
            <div class="highlighter-container">
              <webhighlights-highlighter
                class="highlighter slideIn"
                .chromeSettings=${this.chromeSettings}
              ></webhighlights-highlighter>
            </div>
          `:""}
    `}}l.styles=e.css`
    ${(0,e.unsafeCSS)(h)}
  `,n([(0,o.property)()],l.prototype,"show",void 0),n([(0,o.property)()],l.prototype,"menuWidth",void 0),n([(0,o.property)()],l.prototype,"firstInitWasCalled",void 0),n([(0,o.state)()],l.prototype,"chromeSettings",void 0),s.y.define(a.TAG,l)})()})();